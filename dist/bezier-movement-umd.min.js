!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).BezierMovement=e()}(this,function(){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e,n){var r=p(t,2),i=r[0],o=r[1],a=p(e,2);return{x:i+(a[0]-i)*n,y:o+(a[1]-o)*n}}function a(t,e,n,r){var i=p(t,2),o=i[0],a=i[1],s=p(e,2),c=s[0],u=s[1],l=p(n,2);return{x:(1-r)*(1-r)*o+2*r*(1-r)*l[0]+r*r*c,y:(1-r)*(1-r)*a+2*r*(1-r)*l[1]+r*r*u}}function s(t,e,n,r,i){var o=p(t,2),a=o[0],s=o[1],c=p(e,2),u=c[0],l=c[1],f=p(n,2),h=f[0],y=f[1],d=p(r,2);return{x:a*(1-i)*(1-i)*(1-i)+3*h*i*(1-i)*(1-i)+3*d[0]*i*i*(1-i)+u*i*i*i,y:s*(1-i)*(1-i)*(1-i)+3*y*i*(1-i)*(1-i)+3*d[1]*i*i*(1-i)+l*i*i*i}}function u(t){return void 0!==t}return function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="quadratic",this.autoPlay=!1,this.trackPoints=[],this.fixedPoints=[],this.container=document.body,this.setOptions(t),this.autoPlay&&this.play()}var t,n,r;return t=e,(n=[{key:"refreshTrack",value:function(){return this.removeTrack(),this.genTrack(),this}},{key:"removeTrack",value:function(){return this.trackPoints.forEach(function(t){t.remove()}),this.trackPoints=[],this}},{key:"genTrack",value:function(t){var e=0<arguments.length&&void 0!==t?t:0,n=this._calcT(e,n),r=this._calcBezierPoint(n),i=document.createElement("div");return this.trackPoints.push(i),i.className="track-point",i.style.position="absolute",i.style.left=r.x+"px",i.style.top=r.y+"px",this.container.appendChild(i),n<1&&(e++,this.genTrack(e)),this}},{key:"toggleTrack",value:function(e){return this.trackPoints.forEach(function(t){t.style.display=e?"block":"none"}),this}},{key:"_setOptionValue",value:function(t,e,n,r){var i,o=2<arguments.length&&void 0!==n?n:[],a=3<arguments.length&&void 0!==r&&r;if(u(e)){if(0!==o.length&&(i=e,!(0<=o.indexOf(i))))throw new Error("[error]: the value of the ".concat(t," option must be one of ").concat(o,"."));this[t]=e||this[t]}else if(a)throw new Error("[error]: the value of the ".concat(t," option is required."))}},{key:"setOptions",value:function(t){var e,n,r={type:[["linear","quadratic","cubic"]],target:[[],!0],container:[[],!0],start:[[],!0],end:[[],!0],autoPlay:[[!0,!1]],fixedPoints:[[],!0],onEnd:[[],!1]};t.type&&(this._setOptionValue.apply(this,["type",t.type].concat(r.type)),delete t.type),t.fixedPoints&&(e=t.fixedPoints.length,n=this.type,[["linear",0,"zero"],["quadratic",1,"one"],["cubic",2,"two"]].forEach(function(t){if(n===t[0]&&e!==t[1])throw new Error("[error]: the length of fixedPoints should be ".concat(t[2]," when type is ").concat(t[0],"."))}),this._setOptionValue.apply(this,["fixedPoints",t.fixedPoints].concat(r.fixedPoints)),delete t.fixedPoints);for(var i=0,o=Object.entries(t);i<o.length;i++){var a=p(o[i],2),s=a[0],c=a[1];if(!u(r[s]))throw new Error("[error]: the ".concat(s," option isn't existed."));this._setOptionValue.apply(this,[s,c].concat(r[s]))}return this}},{key:"bezier",value:function(t){return"linear"===t?o:"quadratic"===t?a:s}},{key:"_calcBezierPoint",value:function(t){var e=this.type,n=this.start,r=this.end,i="linear"===e?o(n,r,t):"quadratic"===e?a(n,r,this.fixedPoints[0],t):s(n,r,this.fixedPoints[0],this.fixedPoints[1],t);return i}},{key:"_calcT",value:function(t){return 1/30*t}},{key:"setCalcT",value:function(t){return this._calcT=t,this}},{key:"_move",value:function(t,e){var n=this,r=this._calcT(e,r),i=this._calcBezierPoint(r);t.style.left=i.x+"px",t.style.top=i.y+"px",r<1?(e++,requestAnimationFrame(function(){n._move(t,e)})):u(this.onEnd)&&this.onEnd()}},{key:"play",value:function(){var t=this,e=this.target,n=this.start,r=this.end;if(![e,n,r].every(u))throw new Error("[error]: the target, start and end option must be defined.");return e.style.position="absolute",requestAnimationFrame(function(){t._move(e,0)}),this}}])&&i(t.prototype,n),r&&i(t,r),e}()});
